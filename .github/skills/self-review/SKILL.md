---
name: self-review
description: "セルフレビュースキル。計画していた実装が完了したときにブランチ差分をチェック。Use when: セルフレビュー、実装完了後のチェック、PR作成前の確認、コミット前の確認を依頼された時。"
---

# セルフレビュー（ブランチ差分チェック）

計画していた実装が完了したときに、自分の変更内容を客観的に確認するためのセルフレビュースキルです。

## セルフレビューの目的

- **バグや問題の早期発見**: レビュアーに指摘される前に自分で問題を発見
- **コードの品質向上**: 可読性、保守性、パフォーマンスの向上
- **レビュアーの負担軽減**: 明確で高品質な変更により、レビュー時間を短縮
- **PR作成時の説明の質向上**: 変更内容を深く理解した上で説明を作成

## セルフレビュー実施のタイミング

1. **コミット前**: 小さな変更でも差分を確認
2. **機能完成時**: 機能全体の変更を通しで確認（**推奨**）
3. **PR作成前**: 最終チェックとして必ず実施
4. **レビュー指摘後**: 修正内容が適切か確認

## セルフレビュー手順

### 1. ベースブランチとの差分を確認

```bash
# 派生元ブランチ（通常はmain）との差分を確認
git diff main...HEAD

# 変更ファイル一覧を確認
git diff main...HEAD --name-only

# 統計情報を確認
git diff main...HEAD --stat

# 現在の未コミット変更も確認
git diff
```

### 2. レビュー観点でチェック

各レビュー観点から自分のコードを確認：

| 観点 | チェック内容 |
| ----- | ------------- |
| **意図した変更のみか** | 不要な変更や予期しない変更が含まれていないか |
| **コード品質** | 可読性、保守性、命名規則は適切か |
| **デバッグコードの削除** | console.log、コメントアウトされたコードは削除したか |
| **エラーハンドリング** | 適切にエラーを処理しているか |
| **テストカバレッジ** | 変更に対応するテストが追加されているか |
| **ドキュメント** | 必要なドキュメントは更新されているか |
| **セキュリティ** | 脆弱性の原因となるコードはないか |
| **パフォーマンス** | 非効率な実装はないか |
| **コミット粒度** | 1つの目的に絞られているか、複数の変更が混ざっていないか |

### 3. コミット単位でレビュー

```bash
# コミット一覧を確認
git log main...HEAD --oneline

# 各コミットの差分を確認
git show <commit-hash>
```

各コミットについて:
- コミットメッセージが適切か
- コミット粒度が適切か（1コミット1機能）
- コミット間で論理的な流れになっているか
- 各コミット時点でテストが通るか

### 4. AI Agentによるセルフレビュー

code-reviewスキルを使用して自動レビューを実施：

```bash
"ブランチの差分をレビューしてください"
```

AI Agentが自動的に:
- ベースブランチとの差分を分析
- 問題点や改善提案を提示
- セキュリティやパフォーマンスの観点で評価

## セルフレビューチェックリスト

### 変更内容の確認

- [ ] 意図した変更のみが含まれている
- [ ] デバッグコード（console.log等）を削除した
- [ ] コメントアウトされた不要なコードを削除した
- [ ] コード品質（可読性、保守性）が適切

### 品質保証

- [ ] エラーハンドリングが適切
- [ ] テストが追加されている
- [ ] ドキュメントが更新されている
- [ ] セキュリティ上の問題がない
- [ ] パフォーマンス上の問題がない

### コミットの確認

- [ ] コミットメッセージが適切
- [ ] コミット粒度が適切（1コミット1機能）
- [ ] 各コミットが独立してレビュー・revert可能
- [ ] 各コミット時点でテストが通る

## 実施例

### 例1: PR作成前のセルフレビュー

```bash
# 1. 差分を確認
git diff main...HEAD --stat

# 2. ファイル一覧を確認し、意図しない変更がないかチェック
git diff main...HEAD --name-only

# 3. 詳細な差分を確認
git diff main...HEAD

# 4. AI Agentによるレビュー
"main ブランチとの差分をレビューしてください"

# 5. 問題があれば修正して再度コミット
```

### 例2: コミット前のセルフレビュー

```bash
# 1. 現在の未コミット変更を確認
git diff

# 2. デバッグコードや不要な変更がないかチェック
# 3. 問題なければステージングしてコミット
git add <files>
git commit
```

### 例3: 機能完成時のセルフレビュー（推奨）

```bash
# 1. 全コミットを確認
git log main...HEAD --oneline

# 2. 全体の差分を確認
git diff main...HEAD --stat
git diff main...HEAD

# 3. 各コミットを個別に確認
git show <commit-hash>

# 4. AI Agentによる包括的なレビュー
"機能実装が完了しました。ブランチ全体をレビューしてください"

# 5. チェックリストを確認
# 6. 問題があれば修正コミットを追加
```

## 統合ワークフロー

セルフレビューを他のスキルと組み合わせた開発ワークフロー：

### 1. 実装フェーズ

```bash
# TDDで実装
"test-driven-developmentスキルで機能を実装"

# 適切な粒度でコミット
"git-commitスキルで変更をコミット"
```

### 2. セルフレビューフェーズ（実装完了時）

```bash
# セルフレビュー実施
"self-reviewスキルでブランチをレビュー"

# 問題があれば修正
```

### 3. PR作成フェーズ

```bash
# 最終セルフレビュー
"self-reviewスキルで最終チェック"

# PR作成
"pull-requestスキルでPRを作成"
```

## 他のスキルとの関連

- **git-commit**: コミット前にセルフレビューを実施してコミット粒度を確認
- **pull-request**: PR作成前にセルフレビューを実施して変更内容を確認
- **code-review**: セルフレビューで使用するレビュー観点を参照
- **test-driven-development**: 実装完了後にセルフレビューを実施

## 重要な注意事項

1. **実装完了時に必ず実施**: 機能が完成したら、必ずセルフレビューを実施する
2. **チェックリストを活用**: すべての項目を確認する
3. **AI Agentを活用**: 自分では気づかない問題を発見できる
4. **問題は即座に修正**: 発見した問題は先送りせず即座に修正する
5. **レビュアーの視点で確認**: 自分のコードを初めて見る人の視点で確認する
